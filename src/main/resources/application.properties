# ============================================================================
# SPRING BOOT APPLICATION CONFIGURATION
# ============================================================================

# Application Basics
spring.application.name=sellstack
spring.main.banner-mode=console
spring.main.allow-circular-references=false

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================
server.port=8080
server.servlet.context-path=/
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.error.include-stacktrace=never
server.error.include-message=on_param
server.error.whitelabel.enabled=false
server.servlet.session.timeout=30m
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.same-site=strict

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
spring.datasource.url=jdbc:postgresql://localhost:5432/sell_stack
spring.datasource.username=postgres
spring.datasource.password=Akshay@123
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ============================================================================
# JPA / HIBERNATE CONFIGURATION
# ============================================================================
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.batch_versioned_data=true
spring.jpa.properties.hibernate.query.fail_on_pagination_over_collection_fetch=true
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.time_zone=Asia/Kolkata
spring.jpa.properties.hibernate.default_schema=public

# ========== FLYWAY CONFIGURATION ==========
spring.flyway.enabled=false
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.validate-on-migrate=true

# ============================================================================
# JWT CONFIGURATION
# ============================================================================
jwt.secret=your-very-very-very-very-long-secret-key-minimum-32-chars-for-production-change-this
jwt.access-token-validity-seconds=900
jwt.refresh-token-validity-seconds=2592000
jwt.issuer=sellstack
jwt.audience=sellstack-api

# ============================================================================
# OTP CONFIGURATION
# ============================================================================
otp.validity.minutes=5
otp.max.attempts=5
otp.resend.cooldown.seconds=60
otp.length=6
otp.max.devices=5

# ============================================================================
# SESSION CONFIGURATION
# ============================================================================
session.max.devices=5
session.refresh.token.validity.days=30
session.access.token.validity.minutes=15
session.inactivity.hours=168  # 7 days

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================
security.login.max.attempts=5
security.login.attempt.window.minutes=15
security.password.min.length=8
security.password.require.uppercase=true
security.password.require.lowercase=true
security.password.require.number=true
security.password.require.special.char=true

# ============================================================================
# RATE LIMITING CONFIGURATION
# ============================================================================
rate.limit.cleanup.hours=24
rate.limit.login.max.attempts=5
rate.limit.login.window.minutes=15
rate.limit.otp.max.attempts=3
rate.limit.otp.window.minutes=5
rate.limit.ip.max.attempts=10
rate.limit.ip.window.minutes=5

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
cors.allowed-origins=http://localhost:3000,http://localhost:8080
cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
cors.allowed-headers=Authorization,Content-Type,X-Requested-With,Accept,Origin,X-CSRF-Token,X-Forwarded-For,X-Device-Id,X-Client-Version
cors.exposed-headers=Authorization,X-CSRF-Token,X-Rate-Limit-Remaining
cors.allow-credentials=true
cors.max-age=3600

# ============================================================================
# EMAIL CONFIGURATION (For OTP/Notifications)
# ============================================================================
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=your-email@gmail.com
spring.mail.password=your-app-password
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000
spring.mail.default-encoding=UTF-8

# ============================================================================
# SMS CONFIGURATION (For OTP - Example using Twilio)
# ============================================================================
# twilio.account-sid=your_account_sid
# twilio.auth-token=your_auth_token
# twilio.phone-number=+1234567890
# sms.provider=twilio # or msg91, nexmo, etc.

# ============================================================================
# JACKSON CONFIGURATION
# ============================================================================
spring.jackson.time-zone=Asia/Kolkata
spring.jackson.date-format=yyyy-MM-dd'T'HH:mm:ss.SSSXXX
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.indent-output=false
spring.jackson.default-property-inclusion=non_null

# ============================================================================
# ACTUATOR CONFIGURATION
# ============================================================================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true
management.metrics.export.prometheus.enabled=true
management.health.db.enabled=true
management.health.diskspace.enabled=true
management.health.defaults.enabled=true
management.endpoints.web.base-path=/actuator
management.endpoints.web.path-mapping.health=health

# ============================================================================
# SWAGGER / OPENAPI CONFIGURATION
# ============================================================================
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.swagger-ui.display-request-duration=true
springdoc.swagger-ui.disable-swagger-default-url=true
springdoc.swagger-ui.use-root-path=true
springdoc.api-docs.enabled=true
springdoc.cache.disabled=true
springdoc.default-produces-media-type=application/json
springdoc.default-consumes-media-type=application/json
springdoc.paths-to-match=/api/**

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
logging.level.root=WARN
logging.level.com.stack.sellstack=INFO
logging.level.org.springframework=WARN
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN
logging.level.org.hibernate=WARN
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.transaction=DEBUG
logging.level.org.springframework.jdbc=DEBUG

# Console logging pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} %highlight(%-5level) [%thread] %cyan(%logger{36}) - %msg%n

# File logging configuration
logging.file.name=logs/sellstack.log
logging.file.max-size=10MB
logging.file.max-history=30
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%thread] %logger{36} - %msg%n
logging.logback.rollingpolicy.max-file-size=10MB
logging.logback.rollingpolicy.max-history=30
logging.logback.rollingpolicy.total-size-cap=1GB

# ============================================================================
# SCHEDULING CONFIGURATION
# ============================================================================
spring.task.scheduling.pool.size=5
spring.task.scheduling.thread-name-prefix=scheduled-task-
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=100
spring.task.execution.thread-name-prefix=async-task-

# ============================================================================
# VALIDATION CONFIGURATION
# ============================================================================
spring.mvc.throw-exception-if-no-handler-found=true
spring.web.resources.add-mappings=false

# ============================================================================
# FILE UPLOAD CONFIGURATION
# ============================================================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.file-size-threshold=2KB
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# ============================================================================
# CACHE CONFIGURATION
# ============================================================================
spring.cache.type=simple
spring.cache.cache-names=otpCache,userCache,rateLimitCache
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=300s

# ============================================================================
# INTERNATIONALIZATION
# ============================================================================
spring.messages.basename=messages/messages
spring.messages.encoding=UTF-8
spring.messages.cache-duration=3600
spring.messages.fallback-to-system-locale=true


# ========== AWS CONFIGURATION (LocalStack) ==========
aws.s3.bucket-name=sellstack-dev
aws.s3.endpoint=http://localhost:4566
aws.s3.region=ap-south-1
aws.s3.access-key=test
aws.s3.secret-key=test
aws.s3.path-style-access-enabled=true
aws.s3.presigned-url-expiry-minutes=15
aws.s3.download-url-expiry-hours=24

# ========== RAZORPAY CONFIGURATION (Test Mode) ==========
razorpay.key-id=rzp_test_xxxxxxxxxxxx
razorpay.key-secret=test_xxxxxxxxxxxxxxxxxxxx
razorpay.webhook-secret=test_webhook_secret

# ========== FILE VALIDATION CONFIGURATION ==========
file.validation.allowed-mime-types=application/pdf,application/zip,application/x-zip-compressed,video/mp4,audio/mpeg,image/jpeg,image/png,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document
file.validation.allowed-extensions=pdf,zip,rar,mp4,mp3,jpg,jpeg,png,doc,docx,txt
file.validation.blocked-extensions=exe,bat,cmd,sh,php,js,html,htm
file.validation.max-file-size-bytes=524288000
file.validation.max-image-size-bytes=10485760
file.validation.max-thumbnail-size-bytes=2097152
file.validation.enable-virus-scanning=false
file.validation.enable-image-optimization=true
file.validation.image-quality=85
file.validation.thumbnail-width=400
file.validation.thumbnail-height=400
file.validation.enable-watermarking=false

# ========== FEATURE FLAGS ==========
feature.ai-sales-page.enabled=true
feature.whatsapp-delivery.enabled=true
feature.automatic-payouts.enabled=true

# ========== SECURITY HEADERS ==========
security.headers.content-security-policy=default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://api.razorpay.com;
security.headers.hsts.max-age-seconds=31536000
security.headers.hsts.include-subdomains=true
security.headers.hsts.preload=true
security.headers.frame-options=DENY
security.headers.xss-protection=enabled

# ========== DEBUG CONFIGURATION ==========
spring.devtools.restart.enabled=true
spring.devtools.restart.poll-interval=2000
spring.devtools.restart.quiet-period=400
logging.level.com.sellstack=DEBUG

# ============================================================================
# PROFILES CONFIGURATION
# ============================================================================
#spring.profiles.active=dev
spring.profiles.include=
# ============================================================================
# SPRING BOOT APPLICATION CONFIGURATION
# ============================================================================

# Application Basics
spring.application.name=sellstack
spring.main.banner-mode=console
spring.main.allow-circular-references=false

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================
server.port=8080
server.servlet.context-path=/
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.error.include-stacktrace=never
server.error.include-message=on_param
server.error.whitelabel.enabled=false
server.servlet.session.timeout=30m
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.same-site=strict

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
spring.datasource.url=jdbc:postgresql://localhost:5432/sell_stack
spring.datasource.username=postgres
spring.datasource.password=Akshay@123
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ============================================================================
# JPA / HIBERNATE CONFIGURATION
# ============================================================================
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.batch_versioned_data=true
spring.jpa.properties.hibernate.query.fail_on_pagination_over_collection_fetch=true
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.time_zone=Asia/Kolkata
spring.jpa.properties.hibernate.default_schema=public
spring.jpa.properties.hibernate.types.print.banner=false

# ========== FLYWAY CONFIGURATION ==========
spring.flyway.enabled=false
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.validate-on-migrate=true

# ============================================================================
# JWT CONFIGURATION
# ============================================================================
jwt.secret=your-very-very-very-very-long-secret-key-minimum-32-chars-for-production-change-this
jwt.access-token-validity-seconds=900
jwt.refresh-token-validity-seconds=2592000
jwt.issuer=sellstack
jwt.audience=sellstack-api

# ============================================================================
# OTP CONFIGURATION
# ============================================================================
otp.validity.minutes=5
otp.max.attempts=5
otp.resend.cooldown.seconds=60
otp.length=6
otp.max.devices=5

# ============================================================================
# SESSION CONFIGURATION
# ============================================================================
session.max.devices=5
session.refresh.token.validity.days=30
session.access.token.validity.minutes=15
session.inactivity.hours=168  # 7 days

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================
security.login.max.attempts=5
security.login.attempt.window.minutes=15
security.password.min.length=8
security.password.require.uppercase=true
security.password.require.lowercase=true
security.password.require.number=true
security.password.require.special.char=true

# ============================================================================
# RATE LIMITING CONFIGURATION
# ============================================================================
rate.limit.cleanup.hours=24
rate.limit.login.max.attempts=5
rate.limit.login.window.minutes=15
rate.limit.otp.max.attempts=3
rate.limit.otp.window.minutes=5
rate.limit.ip.max.attempts=10
rate.limit.ip.window.minutes=5
rate.limit.email.max-requests=100
rate.limit.email.window-minutes=60
rate.limit.whatsapp.max-requests=50
rate.limit.whatsapp.window-minutes=60

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
cors.allowed-origins=http://localhost:3000,http://localhost:8080
cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
cors.allowed-headers=Authorization,Content-Type,X-Requested-With,Accept,Origin,X-CSRF-Token,X-Forwarded-For,X-Device-Id,X-Client-Version
cors.exposed-headers=Authorization,X-CSRF-Token,X-Rate-Limit-Remaining
cors.allow-credentials=true
cors.max-age=3600

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================
# Email Provider (SMTP)
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=your-email@gmail.com
spring.mail.password=your-app-password
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000
spring.mail.default-encoding=UTF-8

# Email Templates Configuration
email.templates.default-sender=noreply@sellstack.com
email.templates.default-sender-name=SellStack
email.templates.base-url=http://localhost:8080
email.templates.retry.max-attempts=3
email.templates.retry.delay-millis=5000
email.templates.async-enabled=true
email.templates.queue-enabled=true
email.templates.queue-batch-size=50

# ============================================================================
# SMS CONFIGURATION
# ============================================================================
# SMS Provider - Twilio
twilio.account-sid=your_account_sid
twilio.auth-token=your_auth_token
twilio.phone-number=+1234567890
sms.provider=twilio

# SMS Provider - MSG91
msg91.authkey=your_auth_key
msg91.sender=SELSTK
msg91.route=4
msg91.country=91

# SMS Configuration
sms.otp.template-id=OTP_TEMPLATE_ID
sms.retry.max-attempts=3
sms.retry.delay-millis=3000

# ============================================================================
# WHATSAPP CONFIGURATION
# ============================================================================
# WhatsApp Business API Configuration
whatsapp.provider=twilio  # twilio, meta, gupshup
whatsapp.enabled=true
whatsapp.queue.enabled=true
whatsapp.queue.batch-size=20
whatsapp.queue.poll-interval=30000
whatsapp.queue.max-retries=3
whatsapp.queue.retry-delay=60000
whatsapp.templates.default-language=en_US
whatsapp.templates.approval-required=true

# WhatsApp - Twilio Configuration
whatsapp.twilio.account-sid=your_twilio_account_sid
whatsapp.twilio.auth-token=your_twilio_auth_token
whatsapp.twilio.phone-number-id=your_twilio_phone_number_id
whatsapp.twilio.messaging-service-sid=your_messaging_service_sid
whatsapp.twilio.webhook-url=https://your-domain.com/api/v1/notifications/webhook/whatsapp

# WhatsApp - Meta Configuration
whatsapp.meta.access-token=your_meta_access_token
whatsapp.meta.phone-number-id=your_meta_phone_number_id
whatsapp.meta.business-account-id=your_business_account_id
whatsapp.meta.api-version=v17.0
whatsapp.meta.webhook-verify-token=your_webhook_verify_token
whatsapp.meta.webhook-url=https://your-domain.com/api/v1/notifications/webhook/whatsapp

# WhatsApp - Gupshup Configuration
whatsapp.gupshup.api-key=your_gupshup_api_key
whatsapp.gupshup.app-name=your_gupshup_app_name
whatsapp.gupshup.source=your_source_number
whatsapp.gupshup.api-endpoint=https://api.gupshup.io/sm/api/v1

# ============================================================================
# NOTIFICATION CONFIGURATION
# ============================================================================
notification.email.enabled=true
notification.whatsapp.enabled=true
notification.sms.enabled=false
notification.push.enabled=false
notification.async.enabled=true
notification.worker.pool.size=5
notification.worker.max-pool-size=10
notification.worker.queue-capacity=1000
notification.worker.keep-alive-seconds=60
notification.batch.size=100
notification.cleanup.days=90

# ============================================================================
# ANALYTICS CONFIGURATION
# ============================================================================
analytics.retention.days=365
analytics.update-interval.minutes=5
analytics.cache.ttl.minutes=10
analytics.daily.report.cron=0 0 2 * * *  # Daily at 2 AM
analytics.monthly.report.cron=0 0 3 1 * *  # Monthly on 1st at 3 AM

# ============================================================================
# TEMPLATE MANAGEMENT CONFIGURATION
# ============================================================================
templates.email.base-path=/templates/email
templates.whatsapp.base-path=/templates/whatsapp
templates.cache.enabled=true
templates.cache.ttl.minutes=30
templates.validation.enabled=true
templates.auto-sync.enabled=false
templates.sync-interval.hours=24

# ============================================================================
# WEBHOOK CONFIGURATION
# ============================================================================
webhook.email.signature-verification=true
webhook.whatsapp.signature-verification=true
webhook.timeout.seconds=10
webhook.max-body-size=1048576  # 1MB
webhook.secret=your_webhook_secret_key

# ============================================================================
# JACKSON CONFIGURATION
# ============================================================================
spring.jackson.time-zone=Asia/Kolkata
spring.jackson.date-format=yyyy-MM-dd'T'HH:mm:ss.SSSXXX
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.indent-output=false
spring.jackson.default-property-inclusion=non_null

# ============================================================================
# ACTUATOR CONFIGURATION
# ============================================================================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true
management.metrics.export.prometheus.enabled=true
management.health.db.enabled=true
management.health.diskspace.enabled=true
management.health.defaults.enabled=true
management.endpoints.web.base-path=/actuator
management.endpoints.web.path-mapping.health=health

# Custom Health Indicators
management.health.email.enabled=true
management.health.whatsapp.enabled=true
management.health.redis.enabled=false

# ============================================================================
# SWAGGER / OPENAPI CONFIGURATION
# ============================================================================
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.swagger-ui.display-request-duration=true
springdoc.swagger-ui.disable-swagger-default-url=true
springdoc.swagger-ui.use-root-path=true
springdoc.api-docs.enabled=true
springdoc.cache.disabled=true
springdoc.default-produces-media-type=application/json
springdoc.default-consumes-media-type=application/json
springdoc.paths-to-match=/api/**
springdoc.packages-to-scan=com.stack.sellstack.controller

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
logging.level.root=WARN
logging.level.com.stack.sellstack=INFO
logging.level.org.springframework=WARN
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN
logging.level.org.hibernate=WARN
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.transaction=DEBUG
logging.level.org.springframework.jdbc=DEBUG

# Notification specific logging
logging.level.com.stack.sellstack.service.notification=DEBUG
logging.level.com.stack.sellstack.controller.notification=INFO

# Console logging pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} %highlight(%-5level) [%thread] %cyan(%logger{36}) - %msg%n

# File logging configuration
logging.file.name=logs/sellstack.log
logging.file.max-size=10MB
logging.file.max-history=30
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%thread] %logger{36} - %msg%n
logging.logback.rollingpolicy.max-file-size=10MB
logging.logback.rollingpolicy.max-history=30
logging.logback.rollingpolicy.total-size-cap=1GB

# ============================================================================
# SCHEDULING CONFIGURATION
# ============================================================================
spring.task.scheduling.pool.size=5
spring.task.scheduling.thread-name-prefix=scheduled-task-
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=100
spring.task.execution.thread-name-prefix=async-task-

# Notification Scheduler
notification.scheduler.email.queue.processor.cron=*/30 * * * * *  # Every 30 seconds
notification.scheduler.whatsapp.queue.processor.cron=*/30 * * * * *
notification.scheduler.cleanup.queue.cron=0 0 1 * * *  # Daily at 1 AM
notification.scheduler.retry.failed.cron=0 */5 * * * *  # Every 5 minutes

# ============================================================================
# VALIDATION CONFIGURATION
# ============================================================================
spring.mvc.throw-exception-if-no-handler-found=true
spring.web.resources.add-mappings=false
spring.mvc.problemdetails.enabled=true

# ============================================================================
# FILE UPLOAD CONFIGURATION
# ============================================================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.file-size-threshold=2KB
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# ============================================================================
# CACHE CONFIGURATION
# ============================================================================
spring.cache.type=simple
spring.cache.cache-names=otpCache,userCache,rateLimitCache,emailTemplates,whatsappTemplates
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=300s

# Template Cache Configuration
cache.templates.email.ttl.minutes=30
cache.templates.whatsapp.ttl.minutes=30
cache.templates.max.size=100

# ============================================================================
# INTERNATIONALIZATION
# ============================================================================
spring.messages.basename=messages/messages
spring.messages.encoding=UTF-8
spring.messages.cache-duration=3600
spring.messages.fallback-to-system-locale=true

# ============================================================================
# AWS CONFIGURATION (LocalStack)
# ============================================================================
aws.s3.bucket-name=sellstack-prod-assets-v1
aws.s3.endpoint=http://s3.localhost.localstack.cloud:4566
aws.s3.region=ap-south-1
aws.s3.access-key=test
aws.s3.secret-key=test
# aws.s3.path-style-access-enabled=true  # <-- You can REMOVE or set to false
aws.s3.presigned-url-expiry-minutes=15
aws.s3.download-url-expiry-hours=24

# ============================================================================
# RAZORPAY CONFIGURATION (Test Mode)
# ============================================================================
razorpay.key-id=rzp_test_xxxxxxxxxxxx
razorpay.key-secret=test_xxxxxxxxxxxxxxxxxxxx
razorpay.webhook-secret=test_webhook_secret

# ============================================================================
# FILE VALIDATION CONFIGURATION
# ============================================================================
file.validation.allowed-mime-types=application/pdf,application/zip,application/x-zip-compressed,video/mp4,audio/mpeg,image/jpeg,image/png,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document
file.validation.allowed-extensions=pdf,zip,rar,mp4,mp3,jpg,jpeg,png,doc,docx,txt
file.validation.blocked-extensions=exe,bat,cmd,sh,php,js,html,htm
file.validation.max-file-size-bytes=524288000
file.validation.max-image-size-bytes=10485760
file.validation.max-thumbnail-size-bytes=2097152
file.validation.enable-virus-scanning=false
file.validation.enable-image-optimization=true
file.validation.image-quality=85
file.validation.thumbnail-width=400
file.validation.thumbnail-height=400
file.validation.enable-watermarking=false

# ============================================================================
# FEATURE FLAGS
# ============================================================================
feature.ai-sales-page.enabled=true
feature.whatsapp-delivery.enabled=true
feature.automatic-payouts.enabled=true
feature.notification-queue.enabled=true
feature.email-templates.enabled=true
feature.whatsapp-templates.enabled=true
feature.analytics-dashboard.enabled=true
feature.webhook-handling.enabled=true

# ============================================================================
# SECURITY HEADERS
# ============================================================================
security.headers.content-security-policy=default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://api.razorpay.com;
security.headers.hsts.max-age-seconds=31536000
security.headers.hsts.include-subdomains=true
security.headers.hsts.preload=true
security.headers.frame-options=DENY
security.headers.xss-protection=enabled

# ============================================================================
# DEBUG CONFIGURATION
# ============================================================================
spring.devtools.restart.enabled=true
spring.devtools.restart.poll-interval=2000
spring.devtools.restart.quiet-period=400
logging.level.com.stack.sellstack=DEBUG

# ============================================================================
# PROFILES CONFIGURATION
# ============================================================================
# spring.profiles.active=dev
spring.profiles.include=

# ============================================================================
# RESILIENCE CONFIGURATION
# ============================================================================
resilience4j.retry.instances.email-service.max-attempts=3
resilience4j.retry.instances.email-service.wait-duration=2s
resilience4j.retry.instances.whatsapp-service.max-attempts=3
resilience4j.retry.instances.whatsapp-service.wait-duration=2s
resilience4j.circuitbreaker.instances.email-service.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.email-service.sliding-window-size=10
resilience4j.circuitbreaker.instances.whatsapp-service.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.whatsapp-service.sliding-window-size=10

# ============================================================================
# AUDIT LOGGING CONFIGURATION
# ============================================================================
audit.logging.enabled=true
audit.logging.database.enabled=true
audit.logging.retention.days=180
audit.logging.notification-events.enabled=true

# ============================================================================
# TEST CONFIGURATION
# ============================================================================
test.notification.mock.enabled=false
test.email.mock.provider=local
test.whatsapp.mock.provider=local